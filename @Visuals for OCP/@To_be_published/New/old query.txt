SELECT `PRODUCTION_OUTPUT_PLAN`.`_id` AS `_id`,
  `PRODUCTION_OUTPUT_PLAN`.`CREATED_BY` AS `CREATED_BY`,
  `PRODUCTION_OUTPUT_PLAN`.`ENTITY_ID` AS `ENTITY_ID`,
  `PRODUCTION_OUTPUT_PLAN`.`ENTITY_NAME` AS `ENTITY_NAME`,
  `PRODUCTION_OUTPUT_PLAN`.`FAMILY_PRODUCT_CODE_ID` AS `FAMILY_PRODUCT_CODE_ID`,
  `PRODUCTION_OUTPUT_PLAN`.`FAMILY_PRODUCT_CODE_NAME` AS `FAMILY_PRODUCT_CODE_NAME`,
  `PRODUCTION_OUTPUT_PLAN`.`FROM_DATE` AS `FROM_DATE`,
  `PRODUCTION_OUTPUT_PLAN`.`IS_PLAN_SELECTED` AS `IS_PLAN_SELECTED`,
  (CASE WHEN (NOT ISNULL(TIMESTAMP(STR_TO_DATE(SUBSTRING(`PRODUCTION_OUTPUT_PLAN`.`PRODUCING_DATE`, 1, 1024), '%Y-%m-%dT%H:%i:%s.%fZ')))) THEN TIMESTAMP(STR_TO_DATE(SUBSTRING(`PRODUCTION_OUTPUT_PLAN`.`PRODUCING_DATE`, 1, 1024), '%Y-%m-%dT%H:%i:%s.%fZ')) WHEN (NOT ISNULL(IFNULL(TIMESTAMP(SUBSTRING(`PRODUCTION_OUTPUT_PLAN`.`PRODUCING_DATE`, 1, 1024)),STR_TO_DATE(SUBSTRING(`PRODUCTION_OUTPUT_PLAN`.`PRODUCING_DATE`, 1, 1024),'%b %e %Y %l:%i%p')))) THEN IFNULL(TIMESTAMP(SUBSTRING(`PRODUCTION_OUTPUT_PLAN`.`PRODUCING_DATE`, 1, 1024)),STR_TO_DATE(SUBSTRING(`PRODUCTION_OUTPUT_PLAN`.`PRODUCING_DATE`, 1, 1024),'%b %e %Y %l:%i%p')) ELSE NULL END) AS `PRODUCING_DATE`,
  `PRODUCTION_OUTPUT_PLAN`.`PRODUCING_VOL_PER_DAY` AS `PRODUCING_VOL_PER_DAY`,
  `PRODUCTION_OUTPUT_PLAN`.`PRODUCT_ID` AS `PRODUCT_ID`,
  `PRODUCTION_OUTPUT_PLAN`.`PRODUCT_NAME` AS `PRODUCT_NAME`,
  `PRODUCTION_OUTPUT_PLAN`.`PRODUCTION_OUTPUT_PLAN_ID` AS `PRODUCTION_OUTPUT_PLAN_ID`,
  `PRODUCTION_OUTPUT_PLAN`.`PRODUCTION_OUTPUT_PLAN_NAME` AS `PRODUCTION_OUTPUT_PLAN_NAME`,
  `PRODUCTION_OUTPUT_PLAN`.`SITE_ID` AS `SITE_ID`,
  `PRODUCTION_OUTPUT_PLAN`.`SITE_NAME` AS `SITE_NAME`,
  `PRODUCTION_OUTPUT_PLAN`.`TO_DATE` AS `TO_DATE`,
  `PRODUCTION_OUTPUT_PLAN`.`UPDATED_BY` AS `UPDATED_BY`,
  `PRODUCTION_OUTPUT_PLAN`.`WHENCREATED` AS `WHENCREATED`,
  `PRODUCTION_OUTPUT_PLAN`.`WHENUPDATED` AS `WHENUPDATED`,
  `PRODUCTION_OUTPUT_PLAN`.`ZONE_ID` AS `ZONE_ID`,
  `PRODUCTION_OUTPUT_PLAN`.`ZONE_NAME` AS `ZONE_NAME`
FROM `PRODUCTION_OUTPUT_PLAN`


GROUP BY
`PRODUCTION_OUTPUT_PLAN`.`CREATED_BY`,
  `PRODUCTION_OUTPUT_PLAN`.`ENTITY_ID`,
  `PRODUCTION_OUTPUT_PLAN`.`ENTITY_NAME`,
  `PRODUCTION_OUTPUT_PLAN`.`FAMILY_PRODUCT_CODE_ID`,
  `PRODUCTION_OUTPUT_PLAN`.`FAMILY_PRODUCT_CODE_NAME`,
  `PRODUCTION_OUTPUT_PLAN`.`FROM_DATE`,
  `PRODUCTION_OUTPUT_PLAN`.`IS_PLAN_SELECTED`,

  `PRODUCTION_OUTPUT_PLAN`.`PRODUCING_VOL_PER_DAY`,
  `PRODUCTION_OUTPUT_PLAN`.`PRODUCT_ID`,
  `PRODUCTION_OUTPUT_PLAN`.`PRODUCT_NAME`,
  `PRODUCTION_OUTPUT_PLAN`.`PRODUCTION_OUTPUT_PLAN_ID`,
  `PRODUCTION_OUTPUT_PLAN`.`PRODUCTION_OUTPUT_PLAN_NAME`,
  `PRODUCTION_OUTPUT_PLAN`.`SITE_ID`,
  `PRODUCTION_OUTPUT_PLAN`.`SITE_NAME`,
  `PRODUCTION_OUTPUT_PLAN`.`TO_DATE`,
  `PRODUCTION_OUTPUT_PLAN`.`UPDATED_BY`,
  `PRODUCTION_OUTPUT_PLAN`.`WHENCREATED`,
  `PRODUCTION_OUTPUT_PLAN`.`WHENUPDATED`,
  `PRODUCTION_OUTPUT_PLAN`.`ZONE_ID`,
  `PRODUCTION_OUTPUT_PLAN`.`ZONE_NAME`
  HAVING `PRODUCTION_OUTPUT_PLAN`.`PRODUCING_VOL_PER_DAY` <> 0